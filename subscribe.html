
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>プッシュ通知登録</title>
</head>
<body>
  <h1>プッシュ通知を有効にする</h1>
  <button id="subscribeButton">通知を登録する</button>
  <script>
    if ('serviceWorker' in navigator && 'PushManager' in window) {
      navigator.serviceWorker.register('sw.js').then(function(registration) {
        document.getElementById('subscribeButton').onclick = function () {
          Notification.requestPermission().then(function(permission) {
            if (permission === 'granted') {
              registration.pushManager.subscribe({
                userVisibleOnly: true,
                applicationServerKey: 'BMDf3mABIQShHIv6n-ExampleKey-YybdL7E='
              }).then(function(subscription) {
                fetch('https://guru-push-server.onrender.com/subscribe', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify(subscription)
                }).then(() => {
                  alert('登録しました！');
                });
              });
            } else {
              alert('通知が拒否されました');
            }
          });
        };
      });
    } else {
      alert('このブラウザではプッシュ通知が使えません。');
    }
  </script>
</body>
</html>
